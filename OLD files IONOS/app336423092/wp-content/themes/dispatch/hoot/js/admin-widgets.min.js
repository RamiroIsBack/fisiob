!function(t){"use strict";t.fn.hootWidgetIconPicker=function(){return this.each(function(){var i=t(this),o=i.siblings(".hoot-of-icon-picker-box"),e=i.siblings(".hoot-of-icon-picked"),n=e.children("i"),d=o.find("i");e.on("click",function(){o.toggle()}),d.on("click",function(){var e=t(this).data("value");d.removeClass("selected");var s=t(this).hasClass("cmb-icon-none")?"":"selected";t(this).addClass(s),n.removeClass().addClass(s+" "+e),i.val(e),i.trigger("change"),o.toggle()})})},t(document).on("click",function(i){t(i.target).closest(".hoot-of-icon-picker-box").length||t(i.target).closest(".hoot-of-icon-picked").length||t(".hoot-of-icon-picker-box").hide()}),t.fn.hootWidgetImageUpload=function(){return this.each(function(){if("undefined"!=typeof wp&&wp.media&&wp.media.editor){var i=t(this),o=i.siblings(".hoot-of-image"),e=i.children(".hoot-of-image-selected-img"),n=i.siblings(".hoot-of-image-remove");n.on("click",function(t){t.preventDefault(),o.val(""),o.trigger("change"),e.css("background-image","none")}),i.on("click",function(t){var n=i.data("frame");return n?(n.open(),!1):(n=wp.media({title:i.data("title"),library:{type:i.data("library").split(",").map(function(t){return t.trim()})},button:{text:i.data("update"),close:!1}}),i.data("frame",n),n.on("select",function(){var t=n.state().get("selection").first().attributes;o.val(t.id),o.trigger("change");var i="";i="undefined"!=typeof t.sizes?"undefined"!=typeof t.sizes.thumbnail?t.sizes.thumbnail.url:t.sizes.full.url:t.icon,e.css("background-image","url("+i+")"),n.close()}),n.open(),!1)})}})},t.fn.hootWidgetCollapser=function(){return this.each(function(){var i=t(this),o=i.siblings(".hoot-collapse-body");i.on("click",function(){o.toggle()})})},t.fn.hootSetupWidget=function(){var i=function(i,n,d){i.find(".hoot-widget-field-group-add").each(function(){var i=t(this),d=i.siblings(".hoot-widget-field-group-items"),s=i.parent(".hoot-widget-field-group").data("id"),r=window.hoot_widget_helper[n][s];i.on("click",function(){var n=parseInt(t(this).data("iterator")),s=parseInt(t(this).data("limit"));if(s){var a=t(this).data("limitmsg"),l=t(this).siblings(".hoot-widget-field-group-items").children().length;if(l+1>=s&&t(this).addClass("maxreached"),l>=s)return a&&alert(a),!1}n++,t(this).data("iterator",n);var g=r.trim().replace(/975318642/g,n),c=t(g);o(c),e(c),c.find(".hoot-of-icon").hootWidgetIconPicker(),c.find(".hoot-of-image-selected").hootWidgetImageUpload(),c.find(".hoot-of-color").wpColorPicker(),d.append(c),d.hasClass("issortable")&&d.sortable("refresh"),i.closest(".hoot-widget-form").find("input").filter(":first").trigger("change")})}),i.find(".hoot-widget-field-group-top").click(function(){t(this).toggleClass("open"),t(this).is(".open")?t(this).siblings(".hoot-widget-field-group-items").find(".hoot-widget-field-group-item-form").show():t(this).siblings(".hoot-widget-field-group-items").find(".hoot-widget-field-group-item-form").hide()})},o=function(i){i.find(".hoot-widget-field-group-item-top").on("click",function(){t(this).siblings(".hoot-widget-field-group-item-form").toggle()})},e=function(i){i.find(".hoot-widget-field-group-remove").on("click",function(){t(this).closest(".hoot-widget-form").find("input").filter(":first").trigger("change"),t(this).closest(".hoot-widget-field-group-items").siblings(".hoot-widget-field-group-add").removeClass("maxreached"),t(this).closest(".hoot-widget-field-group-item").remove()})};return this.each(function(n,d){var s=t(d),r=s.data("class");s.find(".hoot-widget-field-group-items");if(s.data("hoot-form-setup")===!0)return!0;var a=s.closest(".widget");return a.length>0&&a.attr("id").indexOf("__i__")>-1?!0:(s.find(".hoot-of-icon").hootWidgetIconPicker(),s.find(".hoot-of-image-selected").hootWidgetImageUpload(),s.find(".hoot-of-color").wpColorPicker(),s.find(".hoot-collapse-head").hootWidgetCollapser(),i(s,r,!1),o(s),e(s),s.find(".hoot-widget-field-widgetid .widgetid").each(function(){var i=s.closest(".widget").attr("id"),o=t(this).data("baseid");o&&i&&(i=i.substring(i.indexOf(o)),t(this).html(" #"+i))}),void s.trigger("hootwidgetformsetup").data("hoot-form-setup",!0))})},t(".hoot-widget-form").hootSetupWidget(),t(".widgets-holder-wrap").on("click",".widget:has(.hoot-widget-form) .widget-top",function(){var i=t(this).closest(".widget").find(".hoot-widget-form");setTimeout(function(){i.hootSetupWidget()},200)})}(jQuery);